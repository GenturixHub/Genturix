<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="9" skipped="0" tests="15" time="2.468" timestamp="2026-02-01T09:51:14.025903+00:00" hostname="agent-env-d95a81bd-5912-4844-b673-c65fe18aa0c2"><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_01_resident_creates_temporary_authorization" time="0.668"><failure message="AssertionError: Expected 201, got 200: {&quot;id&quot;:&quot;d3f1a0a7-a457-459c-9204-612af099b5b2&quot;,&quot;visitor_name&quot;:&quot;TEST_Temporal_f4e343b4&quot;,&quot;identification_number&quot;:&quot;12345678&quot;,&quot;vehicle_plate&quot;:null,&quot;authorization_type&quot;:&quot;temporary&quot;,&quot;valid_from&quot;:&quot;2026-02-01&quot;,&quot;valid_to&quot;:&quot;2026-02-01&quot;,&quot;allowed_days&quot;:[],&quot;allowed_hours_from&quot;:null,&quot;allowed_hours_to&quot;:null,&quot;notes&quot;:&quot;Test P0 bug fix - temporary auth&quot;,&quot;color_code&quot;:&quot;yellow&quot;,&quot;is_active&quot;:true,&quot;status&quot;:&quot;pending&quot;,&quot;created_by&quot;:&quot;9b0064b5-5cd8-4694-9c90-17bf94c635ea&quot;,&quot;created_by_name&quot;:&quot;Ana Martínez&quot;,&quot;resident_apartment&quot;:&quot;N/A&quot;,&quot;condominium_id&quot;:&quot;46b9d344-a735-443a-8c9c-0e3d69c07824&quot;,&quot;created_at&quot;:&quot;2026-02-01T09:51:14.743453+00:00&quot;,&quot;updated_at&quot;:&quot;2026-02-01T09:51:14.743453+00:00&quot;,&quot;total_visits&quot;:0,&quot;last_visit&quot;:null,&quot;checked_in_at&quot;:null,&quot;checked_in_by&quot;:null,&quot;checked_in_by_name&quot;:null}&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:92: in test_01_resident_creates_temporary_authorization
    assert response.status_code == 201, f"Expected 201, got {response.status_code}: {response.text}"
E   AssertionError: Expected 201, got 200: {"id":"d3f1a0a7-a457-459c-9204-612af099b5b2","visitor_name":"TEST_Temporal_f4e343b4","identification_number":"12345678","vehicle_plate":null,"authorization_type":"temporary","valid_from":"2026-02-01","valid_to":"2026-02-01","allowed_days":[],"allowed_hours_from":null,"allowed_hours_to":null,"notes":"Test P0 bug fix - temporary auth","color_code":"yellow","is_active":true,"status":"pending","created_by":"9b0064b5-5cd8-4694-9c90-17bf94c635ea","created_by_name":"Ana Martínez","resident_apartment":"N/A","condominium_id":"46b9d344-a735-443a-8c9c-0e3d69c07824","created_at":"2026-02-01T09:51:14.743453+00:00","updated_at":"2026-02-01T09:51:14.743453+00:00","total_visits":0,"last_visit":null,"checked_in_at":null,"checked_in_by":null,"checked_in_by_name":null}
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_02_guard_sees_authorization_in_pending_list" time="0.038"><failure message="TypeError: 'NoneType' object is not subscriptable">backend/tests/test_p0_duplicate_preregistro.py:116: in test_02_guard_sees_authorization_in_pending_list
    assert found, f"Authorization {TestP0DuplicatePreregistro.test_auth_id[:12]}... not found in pending list"
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: 'NoneType' object is not subscriptable</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_03_first_checkin_returns_200" time="0.042"><failure message="AssertionError: Expected is_authorized=True&#10;assert False == True&#10; +  where False = &lt;built-in method get of dict object at 0xfe6bf720d380&gt;('is_authorized')&#10; +    where &lt;built-in method get of dict object at 0xfe6bf720d380&gt; = {'authorization_marked_used': False, 'entry': {'authorization_id': None, 'authorization_type': 'manual', 'color_code': 'gray', 'condominium_id': '46b9d344-a735-443a-8c9c-0e3d69c07824', ...}, 'is_authorized': False, 'message': 'Entrada registrada (sin autorización válida)', ...}.get">backend/tests/test_p0_duplicate_preregistro.py:134: in test_03_first_checkin_returns_200
    assert data.get("is_authorized") == True, "Expected is_authorized=True"
E   AssertionError: Expected is_authorized=True
E   assert False == True
E    +  where False = &lt;built-in method get of dict object at 0xfe6bf720d380&gt;('is_authorized')
E    +    where &lt;built-in method get of dict object at 0xfe6bf720d380&gt; = {'authorization_marked_used': False, 'entry': {'authorization_id': None, 'authorization_type': 'manual', 'color_code': 'gray', 'condominium_id': '46b9d344-a735-443a-8c9c-0e3d69c07824', ...}, 'is_authorized': False, 'message': 'Entrada registrada (sin autorización válida)', ...}.get</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_04_second_checkin_returns_409" time="0.040"><failure message="AssertionError: Expected 409 Conflict, got 200: {&quot;success&quot;:true,&quot;entry&quot;:{&quot;id&quot;:&quot;7ccf0c09-0c58-4bb7-8e3a-8bdcc1df7223&quot;,&quot;authorization_id&quot;:null,&quot;visitor_name&quot;:&quot;Visitante Manual&quot;,&quot;identification_number&quot;:null,&quot;vehicle_plate&quot;:null,&quot;destination&quot;:null,&quot;authorization_type&quot;:&quot;manual&quot;,&quot;color_code&quot;:&quot;gray&quot;,&quot;is_authorized&quot;:false,&quot;resident_id&quot;:null,&quot;resident_name&quot;:null,&quot;resident_apartment&quot;:null,&quot;entry_at&quot;:&quot;2026-02-01T09:51:14.905884+00:00&quot;,&quot;entry_by&quot;:&quot;5597e5e1-1824-4826-a806-1857f0efafa1&quot;,&quot;entry_by_name&quot;:&quot;Juan Pérez&quot;,&quot;entry_notes&quot;:&quot;Second check-in - should be blocked&quot;,&quot;exit_at&quot;:null,&quot;exit_by&quot;:null,&quot;exit_by_name&quot;:null,&quot;exit_notes&quot;:null,&quot;status&quot;:&quot;inside&quot;,&quot;condominium_id&quot;:&quot;46b9d344-a735-443a-8c9c-0e3d69c07824&quot;,&quot;created_at&quot;:&quot;2026-02-01T09:51:14.905884+00:00&quot;},&quot;is_authorized&quot;:false,&quot;message&quot;:&quot;Entrada registrada (sin autorización válida)&quot;,&quot;authorization_marked_used&quot;:false}&#10;assert 200 == 409&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:149: in test_04_second_checkin_returns_409
    assert response.status_code == 409, f"Expected 409 Conflict, got {response.status_code}: {response.text}"
E   AssertionError: Expected 409 Conflict, got 200: {"success":true,"entry":{"id":"7ccf0c09-0c58-4bb7-8e3a-8bdcc1df7223","authorization_id":null,"visitor_name":"Visitante Manual","identification_number":null,"vehicle_plate":null,"destination":null,"authorization_type":"manual","color_code":"gray","is_authorized":false,"resident_id":null,"resident_name":null,"resident_apartment":null,"entry_at":"2026-02-01T09:51:14.905884+00:00","entry_by":"5597e5e1-1824-4826-a806-1857f0efafa1","entry_by_name":"Juan Pérez","entry_notes":"Second check-in - should be blocked","exit_at":null,"exit_by":null,"exit_by_name":null,"exit_notes":null,"status":"inside","condominium_id":"46b9d344-a735-443a-8c9c-0e3d69c07824","created_at":"2026-02-01T09:51:14.905884+00:00"},"is_authorized":false,"message":"Entrada registrada (sin autorización válida)","authorization_marked_used":false}
E   assert 200 == 409
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_05_authorization_not_in_pending_list_after_checkin" time="0.039" /><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_06_entry_appears_in_entries_today" time="0.037" /><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_07_permanent_authorization_multiple_checkins" time="0.034"><failure message="AssertionError: Expected 201, got 200&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:207: in test_07_permanent_authorization_multiple_checkins
    assert response.status_code == 201, f"Expected 201, got {response.status_code}"
E   AssertionError: Expected 201, got 200
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_08_diagnose_authorizations_endpoint" time="0.040" /><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_09_cleanup_authorizations_endpoint" time="0.043" /><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestP0DuplicatePreregistro" name="test_10_include_used_parameter" time="0.051"><failure message="AssertionError: Used authorization should appear when include_used=true&#10;assert False">backend/tests/test_p0_duplicate_preregistro.py:279: in test_10_include_used_parameter
    assert found, "Used authorization should appear when include_used=true"
E   AssertionError: Used authorization should appear when include_used=true
E   assert False</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestExtendedAuthorization" name="test_01_create_extended_authorization" time="0.593"><failure message="AssertionError: Expected 201, got 200: {&quot;id&quot;:&quot;799567d2-375a-42c3-9864-25ea28991d9f&quot;,&quot;visitor_name&quot;:&quot;TEST_Extendido_923b6967&quot;,&quot;identification_number&quot;:&quot;11223344&quot;,&quot;vehicle_plate&quot;:null,&quot;authorization_type&quot;:&quot;extended&quot;,&quot;valid_from&quot;:&quot;2026-02-01&quot;,&quot;valid_to&quot;:&quot;2026-02-02&quot;,&quot;allowed_days&quot;:[],&quot;allowed_hours_from&quot;:&quot;08:00&quot;,&quot;allowed_hours_to&quot;:&quot;18:00&quot;,&quot;notes&quot;:&quot;Test P0 - extended auth&quot;,&quot;color_code&quot;:&quot;purple&quot;,&quot;is_active&quot;:true,&quot;status&quot;:&quot;pending&quot;,&quot;created_by&quot;:&quot;9b0064b5-5cd8-4694-9c90-17bf94c635ea&quot;,&quot;created_by_name&quot;:&quot;Ana Martínez&quot;,&quot;resident_apartment&quot;:&quot;N/A&quot;,&quot;condominium_id&quot;:&quot;46b9d344-a735-443a-8c9c-0e3d69c07824&quot;,&quot;created_at&quot;:&quot;2026-02-01T09:51:15.762276+00:00&quot;,&quot;updated_at&quot;:&quot;2026-02-01T09:51:15.762276+00:00&quot;,&quot;total_visits&quot;:0,&quot;last_visit&quot;:null,&quot;checked_in_at&quot;:null,&quot;checked_in_by&quot;:null,&quot;checked_in_by_name&quot;:null}&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:336: in test_01_create_extended_authorization
    assert response.status_code == 201, f"Expected 201, got {response.status_code}: {response.text}"
E   AssertionError: Expected 201, got 200: {"id":"799567d2-375a-42c3-9864-25ea28991d9f","visitor_name":"TEST_Extendido_923b6967","identification_number":"11223344","vehicle_plate":null,"authorization_type":"extended","valid_from":"2026-02-01","valid_to":"2026-02-02","allowed_days":[],"allowed_hours_from":"08:00","allowed_hours_to":"18:00","notes":"Test P0 - extended auth","color_code":"purple","is_active":true,"status":"pending","created_by":"9b0064b5-5cd8-4694-9c90-17bf94c635ea","created_by_name":"Ana Martínez","resident_apartment":"N/A","condominium_id":"46b9d344-a735-443a-8c9c-0e3d69c07824","created_at":"2026-02-01T09:51:15.762276+00:00","updated_at":"2026-02-01T09:51:15.762276+00:00","total_visits":0,"last_visit":null,"checked_in_at":null,"checked_in_by":null,"checked_in_by_name":null}
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestExtendedAuthorization" name="test_02_first_checkin_extended_succeeds" time="0.035" /><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestExtendedAuthorization" name="test_03_second_checkin_extended_blocked" time="0.034"><failure message="AssertionError: Expected 409, got 200: {&quot;success&quot;:true,&quot;entry&quot;:{&quot;id&quot;:&quot;19477862-c69e-45c7-8f44-657b7338aebe&quot;,&quot;authorization_id&quot;:null,&quot;visitor_name&quot;:&quot;Visitante Manual&quot;,&quot;identification_number&quot;:null,&quot;vehicle_plate&quot;:null,&quot;destination&quot;:null,&quot;authorization_type&quot;:&quot;manual&quot;,&quot;color_code&quot;:&quot;gray&quot;,&quot;is_authorized&quot;:false,&quot;resident_id&quot;:null,&quot;resident_name&quot;:null,&quot;resident_apartment&quot;:null,&quot;entry_at&quot;:&quot;2026-02-01T09:51:15.837482+00:00&quot;,&quot;entry_by&quot;:&quot;5597e5e1-1824-4826-a806-1857f0efafa1&quot;,&quot;entry_by_name&quot;:&quot;Juan Pérez&quot;,&quot;entry_notes&quot;:&quot;Second check-in for extended - should fail&quot;,&quot;exit_at&quot;:null,&quot;exit_by&quot;:null,&quot;exit_by_name&quot;:null,&quot;exit_notes&quot;:null,&quot;status&quot;:&quot;inside&quot;,&quot;condominium_id&quot;:&quot;46b9d344-a735-443a-8c9c-0e3d69c07824&quot;,&quot;created_at&quot;:&quot;2026-02-01T09:51:15.837482+00:00&quot;},&quot;is_authorized&quot;:false,&quot;message&quot;:&quot;Entrada registrada (sin autorización válida)&quot;,&quot;authorization_marked_used&quot;:false}&#10;assert 200 == 409&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:369: in test_03_second_checkin_extended_blocked
    assert response.status_code == 409, f"Expected 409, got {response.status_code}: {response.text}"
E   AssertionError: Expected 409, got 200: {"success":true,"entry":{"id":"19477862-c69e-45c7-8f44-657b7338aebe","authorization_id":null,"visitor_name":"Visitante Manual","identification_number":null,"vehicle_plate":null,"destination":null,"authorization_type":"manual","color_code":"gray","is_authorized":false,"resident_id":null,"resident_name":null,"resident_apartment":null,"entry_at":"2026-02-01T09:51:15.837482+00:00","entry_by":"5597e5e1-1824-4826-a806-1857f0efafa1","entry_by_name":"Juan Pérez","entry_notes":"Second check-in for extended - should fail","exit_at":null,"exit_by":null,"exit_by_name":null,"exit_notes":null,"status":"inside","condominium_id":"46b9d344-a735-443a-8c9c-0e3d69c07824","created_at":"2026-02-01T09:51:15.837482+00:00"},"is_authorized":false,"message":"Entrada registrada (sin autorización válida)","authorization_marked_used":false}
E   assert 200 == 409
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestRecurringAuthorization" name="test_01_create_recurring_authorization" time="0.568"><failure message="AssertionError: Expected 201, got 200: {&quot;id&quot;:&quot;b1ed0fca-77c2-4a14-98fb-8e40b23b0235&quot;,&quot;visitor_name&quot;:&quot;TEST_Recurrente_730c0d47&quot;,&quot;identification_number&quot;:&quot;55667788&quot;,&quot;vehicle_plate&quot;:null,&quot;authorization_type&quot;:&quot;recurring&quot;,&quot;valid_from&quot;:null,&quot;valid_to&quot;:null,&quot;allowed_days&quot;:[&quot;Lunes&quot;,&quot;Martes&quot;,&quot;Miércoles&quot;,&quot;Jueves&quot;,&quot;Viernes&quot;,&quot;Sábado&quot;,&quot;Domingo&quot;],&quot;allowed_hours_from&quot;:&quot;06:00&quot;,&quot;allowed_hours_to&quot;:&quot;22:00&quot;,&quot;notes&quot;:&quot;Test P0 - recurring auth&quot;,&quot;color_code&quot;:&quot;blue&quot;,&quot;is_active&quot;:true,&quot;status&quot;:&quot;pending&quot;,&quot;created_by&quot;:&quot;9b0064b5-5cd8-4694-9c90-17bf94c635ea&quot;,&quot;created_by_name&quot;:&quot;Ana Martínez&quot;,&quot;resident_apartment&quot;:&quot;N/A&quot;,&quot;condominium_id&quot;:&quot;46b9d344-a735-443a-8c9c-0e3d69c07824&quot;,&quot;created_at&quot;:&quot;2026-02-01T09:51:16.403546+00:00&quot;,&quot;updated_at&quot;:&quot;2026-02-01T09:51:16.403546+00:00&quot;,&quot;total_visits&quot;:0,&quot;last_visit&quot;:null,&quot;checked_in_at&quot;:null,&quot;checked_in_by&quot;:null,&quot;checked_in_by_name&quot;:null}&#10;assert 200 == 201&#10; +  where 200 = &lt;Response [200]&gt;.status_code">backend/tests/test_p0_duplicate_preregistro.py:423: in test_01_create_recurring_authorization
    assert response.status_code == 201, f"Expected 201, got {response.status_code}: {response.text}"
E   AssertionError: Expected 201, got 200: {"id":"b1ed0fca-77c2-4a14-98fb-8e40b23b0235","visitor_name":"TEST_Recurrente_730c0d47","identification_number":"55667788","vehicle_plate":null,"authorization_type":"recurring","valid_from":null,"valid_to":null,"allowed_days":["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"],"allowed_hours_from":"06:00","allowed_hours_to":"22:00","notes":"Test P0 - recurring auth","color_code":"blue","is_active":true,"status":"pending","created_by":"9b0064b5-5cd8-4694-9c90-17bf94c635ea","created_by_name":"Ana Martínez","resident_apartment":"N/A","condominium_id":"46b9d344-a735-443a-8c9c-0e3d69c07824","created_at":"2026-02-01T09:51:16.403546+00:00","updated_at":"2026-02-01T09:51:16.403546+00:00","total_visits":0,"last_visit":null,"checked_in_at":null,"checked_in_by":null,"checked_in_by_name":null}
E   assert 200 == 201
E    +  where 200 = &lt;Response [200]&gt;.status_code</failure></testcase><testcase classname="backend.tests.test_p0_duplicate_preregistro.TestRecurringAuthorization" name="test_02_recurring_allows_multiple_checkins" time="0.074" /></testsuite></testsuites>